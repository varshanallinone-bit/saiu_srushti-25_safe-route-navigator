<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Safe Route Navigator - Log In</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
body {
font-family: 'Inter', sans-serif;
background-color: #f3f4f6;
}
.container-bg {
background-color: #ffffff;
}
.input-field {
background-color: #f9fafb;
}
.btn-primary {
background-color: #1e40af;
}
.btn-primary:hover {
background-color: #1c3d8a;
}
</style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">
<div class="w-full max-w-sm p-6 sm:p-8 rounded-2xl shadow-2xl container-bg">
<div class="text-center mb-8">
<h1 class="text-3xl font-bold text-gray-800 mb-2">Safe Route Navigator</h1>
<p class="text-gray-600">Your journey, secured.</p>
</div>

    <form id="login-form">
        <div class="mb-4">
            <label for="email" class="block text-sm font-medium text-gray-700 mb-2">Email</label>
            <input type="email" id="email" class="w-full p-3 rounded-lg border border-gray-300 focus:outline-none focus:border-indigo-500 input-field" placeholder="e.g., username@example.com" required>
        </div>
        <div class="mb-6">
            <label for="password" class="block text-sm font-medium text-gray-700 mb-2">Password</label>
            <input type="password" id="password" class="w-full p-3 rounded-lg border border-gray-300 focus:outline-none focus:border-indigo-500 input-field" placeholder="Enter your password" required>
        </div>
        <button type="submit" class="w-full py-3 rounded-lg font-bold text-lg text-white btn-primary">
            Log In
        </button>
        <p id="login-message" class="mt-4 text-center text-sm"></p>
    </form>

    <p class="mt-8 text-center text-gray-600">
        Don't have an account?
        <a href="/create-account" class="text-indigo-600 hover:underline font-medium">Create one</a>
    </p>
</div>

<script>
    const API_URL = "http://127.0.0.1:5000";

    document.getElementById('login-form').addEventListener('submit', async (e) => {
        e.preventDefault();
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;
        const loginMessage = document.getElementById('login-message');

        try {
            const response = await fetch(`${API_URL}/login`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email, password })
            });

            const data = await response.json();
            if (response.ok) {
                loginMessage.textContent = data.message;
                loginMessage.className = "mt-4 text-center text-sm text-green-600";
                window.location.href = data.redirect;
            } else {
                loginMessage.textContent = data.error;
                loginMessage.className = "mt-4 text-center text-sm text-red-600";
            }
        } catch (error) {
            loginMessage.textContent = "Could not connect to the server. Is it running?";
            loginMessage.className = "mt-4 text-center text-sm text-red-600";
        }
    });
</script>

</body>
</html>